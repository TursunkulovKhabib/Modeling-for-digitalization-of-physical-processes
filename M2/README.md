# Проект М2. Столкновение бильярдных шаров

## Условие задачи

Смоделировать столкновение идеально гладкого бильярдного шара:

1. С бесконечно тяжёлой стенкой.
2. С другим таким же шаром.

Решение задачи выполняется двумя способами:

1. **Аналитический** — с применением законов сохранения импульса и механической энергии.
2. **Численный** — с использованием 2-го закона Ньютона и модели взаимодействия тел по:
   - закону Гука \( F = -k \Delta x \),
   - закону Герца \( F = -k \Delta x^{3/2} \).

Также проверяется выполнение законов сохранения по результатам численного моделирования.

---

## Теоретическая часть

### 1. Упругое столкновение с жёсткой стенкой

Предполагаем, что шар массы \( m \) движется со скоростью \( v \) в направлении неподвижной бесконечно тяжёлой стенки.

- После столкновения скорость шара меняет знак:  
  \[
  v' = -v
  \]
- Импульс меняется:  
  \[
  p' = -mv
  \]
- Энергия сохраняется:  
  \[
  E = \frac{1}{2}mv^2
  \]

### 2. Упругое столкновение двух шаров (аналитика)

Пусть два шара масс \( m_1, m_2 \) движутся с начальными скоростями \( v_1, v_2 \) вдоль одной прямой.

Результат абсолютно упругого столкновения:

\[
\begin{cases}
v_1' = \frac{(m_1 - m_2)}{m_1 + m_2} v_1 + \frac{2m_2}{m_1 + m_2} v_2 \\
v_2' = \frac{(m_2 - m_1)}{m_1 + m_2} v_2 + \frac{2m_1}{m_1 + m_2} v_1
\end{cases}
\]

---

## Численное моделирование

### Подход

Моделируем движение двух шаров с начальными положениями \( x_1(0), x_2(0) \) и скоростями \( v_1(0), v_2(0) \).

Используем систему ОДУ:

- по **закону Гука**:
  \[
  F = -k(x_1 - x_2),\quad \text{если } x_1 > x_2
  \]
- по **закону Герца**:
  \[
  F = -k(x_1 - x_2)^{3/2},\quad \text{если } x_1 > x_2
  \]

Затем решаем систему:

\[
\begin{cases}
m_1 \frac{d^2x_1}{dt^2} = F \\
m_2 \frac{d^2x_2}{dt^2} = -F
\end{cases}
\]

Решение производится численно с помощью `scipy.integrate.odeint`.

---

## Проверка законов сохранения

- Считается суммарный импульс:
  \[
  p = m_1 v_1 + m_2 v_2
  \]
- Считается полная механическая энергия:
  \[
  E = \frac{1}{2}m_1 v_1^2 + \frac{1}{2}m_2 v_2^2
  \]

Проверяется их сохранение в течение моделирования.

---

## Результаты сравнения

### Удар с жёсткой стенкой

| № | Масса шара | Скорость до (м/с) | Скорость после (м/с) | Энергия до = после (Дж) | Импульс до | Импульс после |
|---|------------|--------------------|------------------------|--------------------------|-------------|----------------|
| 1 | 1.0        | 5.0                | -5.0                   | 12.5                     | 5.0         | -5.0           |
| 2 | 2.0        | -3.0               | 3.0                    | 9.0                      | -6.0        | 6.0            |

### Столкновение двух шаров

#### Законы Гука и Герца (численно) vs аналитика

| № | $m_1$ | $v_1$ | $m_2$ | $v_2$ | Модель | $v_1'$ аналит | $v_1'$ числ | $v_2'$ аналит | $v_2'$ числ | Энергия сохр.? | Импульс сохр.? |
|---|-------|-------|-------|-------|--------|----------------|--------------|----------------|--------------|----------------|----------------|
| 1 | 1.0   | 2.0   | 1.0   | -1.0  | Гука   | -1.0           | -1.01        | 2.0            | 1.99         | Да             | Да             |
| 2 | 1.0   | 2.0   | 1.0   | -1.0  | Герца  | -1.0           | -1.02        | 2.0            | 1.98         | Да             | Да             |
| 3 | 2.0   | 3.0   | 1.0   | 0.0   | Гука   | 1.0            | 1.02         | 4.0            | 3.98         | Да             | Да             |

---

## Выводы

- Аналитические и численные результаты хорошо согласуются.
- Законы сохранения импульса и энергии выполняются с высокой точностью при численном решении.
- Закон Герца ведёт себя схожим образом с законом Гука, но предполагает более "жёсткий" отклик при деформации.
- При столкновении с жёсткой стенкой результат предсказуем — направление скорости меняется на противоположное, энергия сохраняется.

---

## Вклад участников

### Оськин Максим

- Вывод аналитических решений
- Формулировка постановки задачи и оформление Markdown-документа

### Турсункулов Хабибулло

- Реализация численного моделирования с `scipy`
- Проверка законов сохранения, таблицы сравнения
