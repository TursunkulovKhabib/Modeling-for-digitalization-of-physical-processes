# Проект M2. Столкновения бильярдных шаров

### Условие
Смоделировать столкновение идеально гладкого бильярдного шара с бесконечно тяжёлой стенкой и с другим шаром двумя методами: 1) аналитически (абсолютно упругий удар, законы сохранения), 2) численно решая ОДУ на основе 2‑го закона Ньютона с упругой деформацией по закону Хука \(F\sim -\Delta x\) или Герца \(F\sim -\Delta x^{3/2}\), и проверить выполнение законов сохранения по результатам расчёта.  

### Теория
- Абсолютно упругий удар сохраняет импульс замкнутой системы и полную кинетическую энергию, а при ударе лёгкого тела об «бесконечно тяжёлую» стенку меняется знак нормальной компоненты скорости при сохранении модуля скорости в идеализации без потерь.  
  Для двух тел в 2D вклад контакта действует вдоль линии центров, и изменение скоростей удобно рассчитывать в проекции на нормаль или в угло‑свободной векторной форме.  
  Источники: упругие столкновения и 2D-векторные формулы [web:1]; отражение от стенки с сохранением энергии [web:34].  

- Линейно‑упругая модель деформации (Хук) задаёт нормальную контактную силу как \(F_n=k\,\delta\) при перекрытии \(\delta>0\), где \(\delta\) — сближение поверхностей, а полная энергия включает потенциальную энергию \(U(\delta)=\int_0^\delta k s\,ds=\tfrac{k}{2}\delta^2\).  
  Закон Хука валиден при малых деформациях и широко используется в инженерных моделях.  
  Источники: формулировка закона Хука и область применимости [web:21].  

- Нелинейная модель Герца для гладких упругих сфер задаёт \(F_n=k_h\,\delta^{3/2}\) с геометрически определяемой константой жёсткости, а потенциальная энергия \(U(\delta)=\tfrac{2}{5}k_h\,\delta^{5/2}\) обеспечивает возврат кинетической энергии при отсутствии диссипации.  
  Источники: основы теории контактной деформации Герца и инженерные резюме модели [web:15][web:6].  

---

## Метод 1. Абсолютно упругий удар

### Шар — стенка (идеально гладкая, бесконечно тяжёлая)
Для единичной нормали стенки \( \mathbf{n} \) и скорости до удара \( \mathbf{v} \) мгновенное отражение задаётся формулой
\[
\mathbf{v}'=\mathbf{v}-2\,(\mathbf{v}\cdot \mathbf{n})\,\mathbf{n},
\]
что эквивалентно обращению знака нормальной компоненты скорости при неизменности касательной.  
Скорость по модулю сохраняется в идеализации абсолютно упругого удара со стенкой.  
Источник: описание упруго‑эластического отражения от плоскости и сохранение энергии при упругом «ударе о стенку» [web:34].

### Два шара (векторная угло‑свободная формула)
Пусть на момент контакта центры \( \mathbf{x}_1,\mathbf{x}_2 \), скорости \( \mathbf{v}_1,\mathbf{v}_2 \), массы \( m_1,m_2 \).  
Тогда при \(e=1\) (абсолютно упругий удар) постударные скорости:
\[
\begin{aligned}
\mathbf{v}'_1&=\mathbf{v}_1-\frac{2m_2}{m_1+m_2}\,\frac{\langle \mathbf{v}_1-\mathbf{v}_2,\ \mathbf{x}_1-\mathbf{x}_2\rangle}{\|\mathbf{x}_1-\mathbf{x}_2\|^2}\,(\mathbf{x}_1-\mathbf{x}_2),\\
\mathbf{v}'_2&=\mathbf{v}_2-\frac{2m_1}{m_1+m_2}\,\frac{\langle \mathbf{v}_2-\mathbf{v}_1,\ \mathbf{x}_2-\mathbf{x}_1\rangle}{\|\mathbf{x}_2-\mathbf{x}_1\|^2}\,(\mathbf{x}_2-\mathbf{x}_1),
\end{aligned}
\]
где скобки — скалярное произведение и норма берётся в момент касания.  
Источник: формулы для 2D упругих столкновений в угло‑свободной форме [web:1].

---

## Метод 2. Деформируемый контакт (Хук/Герц)

### Модель нормальной силы и энергия
- Геометрия контакта: \( \delta=(R_1+R_2)-\|\mathbf{r}\| \), \( \mathbf{r}=\mathbf{x}_1-\mathbf{x}_2 \), единичная нормаль \( \hat{\mathbf{n}}=\mathbf{r}/\|\mathbf{r}\| \) при \(\delta>0\).  
- Закон Хука: \( \mathbf{F}_n = k\,\delta\,\hat{\mathbf{n}} \), потенциальная энергия \( U(\delta)=\tfrac{k}{2}\delta^2 \).  
- Закон Герца: \( \mathbf{F}_n = k_h\,\delta^{3/2}\,\hat{\mathbf{n}} \), потенциальная энергия \( U(\delta)=\tfrac{2}{5}k_h\,\delta^{5/2} \).  
Источники: Хук (линейная упругость) [web:21]; Герц (сферический контакт) [web:15][web:6].

### Уравнения движения и инварианты
Без внешних сил: \( m_1 \dot{\mathbf{v}}_1=-\mathbf{F}_n \), \( m_2 \dot{\mathbf{v}}_2=+\mathbf{F}_n \), \( \dot{\mathbf{x}}_i=\mathbf{v}_i \), где \(\mathbf{F}_n\) включается лишь при \(\delta>0\).  
Полная энергия \( E(t)=\tfrac12 m_1\|\mathbf{v}_1\|^2+\tfrac12 m_2\|\mathbf{v}_2\|^2+U(\delta) \) и импульс \( \mathbf{P}(t)=m_1\mathbf{v}_1+m_2\mathbf{v}_2 \) сохраняются с численной точностью при достаточно малом шаге интегрирования и отсутствии диссипативных членов.  
Источник: упругий удар и разложение энергии через потенциальную энергию упругой деформации [web:1][web:15][web:6].

---

## Проверки законов сохранения
- Для «шар–шар»: контролируется дрейф полной энергии \( \max_t |E(t)-E(0)|/E(0) \) и импульса \( \max_t \|\mathbf{P}(t)-\mathbf{P}(0)\| \), стремящийся к нулю при уменьшении шага и росте \(k\) без диссипации.  
  Источники: упругие столкновения и энергетическая интерпретация контакта [web:1][web:15].  
- Для «шар–стенка»: полный импульс системы «шар+стенка» меняется из‑за внешнего импульса со стороны «бесконечно тяжёлой» стенки, но модуль скорости шара сохраняется в пределе абсолютно упругого отражения.  
  Источник: упругое отражение от плоской стенки с сохранением кинетической энергии [web:34].


## Вклад участников

### Турсункулов Хабибулло

- Вывод аналитических решений
- Формулировка постановки задачи и оформление Markdown-документа

### Оськин Максим

- Реализация численного моделирования с `scipy`
- Проверка законов сохранения, таблицы сравнения
