# Проект М2. Столкновения бильярдных шаров

## Условие
Смоделировать столкновение идеально гладкого бильярдного шара с бесконечно тяжёлой стенкой и с другим шаром двумя методами: (1) аналитически по законам сохранения для абсолютно упругого удара, (2) численно, решая ОДУ с упругой деформацией по Хуку ($F \sim \Delta x$) и Герцу ($F \sim \Delta x^{3/2}$), и проверить выполнение законов сохранения по результатам расчёта.

## Теория

### Абсолютно упругий удар
Абсолютно упругий удар сохраняет полную кинетическую энергию и импульс замкнутой системы; для удара о «бесконечно тяжёлую» стенку меняется знак нормальной компоненты скорости при неизменной касательной и сохранении модуля скорости в идеализации без потерь.

#### Шар — стенка (идеально жёсткая плоскость)
Формула зеркального отражения скорости через единичную нормаль $\mathbf{n}$:

$$
\mathbf{v}'=\mathbf{v}-2\ (\mathbf{v}\cdot \mathbf{n})\ \mathbf{n}.
$$

Это обращает нормальную компоненту и сохраняет модуль скорости в пределе абсолютно упругого контакта.

#### Два шара (угло‑свободная векторная форма)
Пусть в момент контакта центры $\mathbf{x}_1,\mathbf{x}_2$, скорости $\mathbf{v}_1,\mathbf{v}_2$, массы $m_1,m_2$. Тогда при $e=1$:

$$
\mathbf{v}'_1=\mathbf{v}_1-\frac{2m_2}{m_1+m_2}\ 
\frac{\langle \mathbf{v}_1-\mathbf{v}_2,\ \mathbf{x}_1-\mathbf{x}_2\rangle}{\lVert\mathbf{x}_1-\mathbf{x}_2\rVert^2}\ 
(\mathbf{x}_1-\mathbf{x}_2),
$$

$$
\mathbf{v}'_2=\mathbf{v}_2-\frac{2m_1}{m_1+m_2}\ 
\frac{\langle \mathbf{v}_2-\mathbf{v}_1,\ \mathbf{x}_2-\mathbf{x}_1\rangle}{\lVert\mathbf{x}_2-\mathbf{x}_1\rVert^2}\ 
(\mathbf{x}_2-\mathbf{x}_1).
$$

Эта запись эквивалентна изменению только нормальной компоненты относительной скорости сфер (касательная не меняется при отсутствии трения).

### Деформируемый контакт (Хук/Герц)

#### Геометрия контакта
Для сфер радиусов $R_1,R_2$ и вектора центров $\mathbf{r}=\mathbf{x}_1-\mathbf{x}_2$:

$$
\delta=(R_1+R_2)-\lVert\mathbf{r}\rVert,\qquad
\hat{\mathbf{n}}=\frac{\mathbf{r}}{\lVert\mathbf{r}\rVert}\quad (\delta>0).
$$

Это определяет перекрытие $\delta$ и единичную нормаль $\hat{\mathbf{n}}$ вдоль линии центров.

#### Закон Хука (линейный)
Нормальная сила и потенциальная энергия:

$$
\mathbf{F}_n = k\ \delta\ \hat{\mathbf{n}} \qquad
U(\delta)=\int_0^\delta k s\ ds=\frac{k}{2}\ \delta^2.
$$

Линейная зависимость силы от деформации корректна для малых упругих деформаций и служит базовой моделью контакта.

#### Закон Герца (сферический контакт)
Нелинейная сила и потенциальная энергия:

$$
\mathbf{F}_n = k_h\ \delta^{3/2}\ \hat{\mathbf{n}} \qquad
U(\delta)=\int_0^\delta k_h s^{3/2} ds=\frac{2}{5}\ k_h\ \delta^{5/2}.
$$

Коэффициент $k_h$ зависит от материалов и геометрии соприкасающихся тел (эффективный модуль Юнга и радиусы кривизны).

#### Уравнения движения (без внешних сил)
Динамика двух шаров:

$$
m_1 \dot{\mathbf{v}}_1=-\mathbf{F}_n,\qquad
m_2 \dot{\mathbf{v}}_2=+\mathbf{F}_n,\qquad
\dot{\mathbf{x}}_i=\mathbf{v}_i.
$$

Полная энергия и суммарный импульс:

$$
E(t)=\tfrac12 m_1\lVert\mathbf{v}_1\rVert^2+\tfrac12 m_2\lVert\mathbf{v}_2\rVert^2+U(\delta),\qquad
\mathbf{P}(t)=m_1\mathbf{v}_1+m_2\mathbf{v}_2.
$$

При упругом контакте без диссипации $E$ и $\mathbf{P}$ сохраняются с точностью интегрирования.

## Метод 1. Аналитическое решение
- Шар–стенка: применить формулу $\,\mathbf{v}'=\mathbf{v}-2(\mathbf{v}\!\cdot\!\mathbf{n})\mathbf{n}\,$ для нормали стенки, что мгновенно даёт постударную скорость без потерь энергии в идеализации.
- Два шара: использовать угло‑свободные формулы постударных скоростей при $e=1$, эквивалентные применению законов сохранения импульса и энергии вдоль линии центров.

## Метод 2. Численное моделирование контакта
- Сила контакта действует только при $\delta>0$ и направлена вдоль $\hat{\mathbf{n}}$; используется либо линейный закон Хука, либо нелинейный закон Герца с соответствующей $U(\delta)$.
- Интегрирование во времени проводится для системы уравнений выше; контролируется сохранение $E(t)$ и $\mathbf{P}(t)$ как критерий качества численного решения без диссипации.

## Проверки законов сохранения
- «Шар–шар»: мониторить дрейф энергии $\max_t |E(t)-E(0)|/E(0)$ и импульса $\max_t \lVert\mathbf{P}(t)-\mathbf{P}(0)\rVert$; при увеличении жёсткости и уменьшении шага решение сходится к аналитическому пределу $e=1$.
- «Шар–стенка»: модуль скорости шара сохраняется в пределе абсолютно упругого отражения, тогда как импульс шара меняется из‑за внешнего импульса от стены; согласуется с формулой зеркального отражения.

## Сравнение аналитического и численного
- Аналитический метод обеспечивает эталонные постударные скорости мгновенно и без численных погрешностей, но не описывает конечное время контакта и нелинейные законы деформации.
- Численное моделирование учитывает форму закона силы (Хук/Герц) и фазу сжатия‑разжатия, позволяет проверять баланс $E$ и $\mathbf{P}$; в пределе больших жёсткостей и малых шагов воспроизводит аналитический результат при $e=1$.

## Вклад участников

### Оськин Максим

- Вывод аналитических решений
- Формулировка постановки задачи и оформление Markdown-документа

### Турсункулов Хабибулло

- Реализация численного моделирования с `scipy`
- Проверка законов сохранения, таблицы сравнения
